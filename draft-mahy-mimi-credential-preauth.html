<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>MIMI Preauthorization based on deep references to MLS Credentials</title>
<meta content="Rohan Mahy" name="author">
<meta content="
       This document describes a syntax called claim pointers that facilitates comparisons in structured credentials, which often have nested levels of hierarchy.
It also describes an new version of the More Instant Messaging Interoperability (MIMI) preauthorization format using claim pointers. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="preauthorization" name="keyword">
<meta content="credential" name="keyword">
<meta content="CWT" name="keyword">
<meta content="JWT" name="keyword">
<meta content="X.509" name="keyword">
<meta content="ASN.1" name="keyword">
<meta content="DER" name="keyword">
<meta content="draft-mahy-mimi-credential-preauth-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-mahy-mimi-credential-preauth.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">MIMI Deep Credential Preauth</td>
<td class="right">January 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">Mahy</td>
<td class="center">Expires 23 July 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">More Instant Messaging Interoperability</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-mahy-mimi-credential-preauth-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-01-19" class="published">19 January 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-07-23">23 July 2026</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Mahy</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">MIMI Preauthorization based on deep references to MLS Credentials</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes a syntax called claim pointers that facilitates comparisons in structured credentials, which often have nested levels of hierarchy.
It also describes an new version of the More Instant Messaging Interoperability (MIMI) preauthorization format using claim pointers.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://rohanmahy.github.io/mimi-credential-preauth/draft-mahy-mimi-credential-preauth.html">https://rohanmahy.github.io/mimi-credential-preauth/draft-mahy-mimi-credential-preauth.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-mahy-mimi-credential-preauth/">https://datatracker.ietf.org/doc/draft-mahy-mimi-credential-preauth/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        More Instant Messaging Interoperability Working Group mailing list (<span><a href="mailto:mimi@ietf.org">mailto:mimi@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/mimi/">https://mailarchive.ietf.org/arch/browse/mimi/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/mimi/">https://www.ietf.org/mailman/listinfo/mimi/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/rohanmahy/mimi-credential-preauth">https://github.com/rohanmahy/mimi-credential-preauth</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 23 July 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-structure-of-credentials" class="internal xref">Structure of Credentials</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-requirements-for-credential" class="internal xref">Requirements for Credential Inspection</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-matching-claims" class="internal xref">Matching claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-matching-map-keys-object-na" class="internal xref">Matching Map Keys, Object Names, and</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-matching-lists-and-sequence" class="internal xref">Matching Lists and Sequences by Absolute Position</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-matching-an-element-in-a-li" class="internal xref">Matching an Element in a List by an Identifier in the List</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-matching-multiple-claim-poi" class="internal xref">Matching multiple claim pointers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-matching-with-numerical-pre" class="internal xref">Matching with Numerical Predicates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="auto internal xref">5.6</a>.  <a href="#name-matching-parts-of-uris-and-" class="internal xref">Matching Parts of URIs and email addresses</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="auto internal xref">5.7</a>.  <a href="#name-matching-arbitrary-substrin" class="internal xref">Matching Arbitrary Substrings</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-some-scraps-here" class="internal xref">some scraps here</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-match-syntax-definition" class="internal xref">Match Syntax Definition</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-more-examples" class="internal xref">More examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-cbor-examples" class="internal xref">CBOR Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a href="#section-8.1.1" class="auto internal xref">8.1.1</a>.  <a href="#name-cbor-example-with-tagged-va" class="internal xref">CBOR example with tagged value access directly as opaque_value</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2">
                    <p id="section-toc.1-1.8.2.1.2.2.1"><a href="#section-8.1.2" class="auto internal xref">8.1.2</a>.  <a href="#name-cbor-example-parsing-into-t" class="internal xref">CBOR example parsing into tagged value</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.3">
                    <p id="section-toc.1-1.8.2.1.2.3.1"><a href="#section-8.1.3" class="auto internal xref">8.1.3</a>.  <a href="#name-cbor-example-with-custom-si" class="internal xref">CBOR example with custom simple values ?? - maybe not needed</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-x509-examples" class="internal xref">X.509 Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="auto internal xref">8.2.1</a>.  <a href="#name-simple-x509-example-cn" class="internal xref">Simple X.509 example (CN)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a href="#section-8.2.2" class="auto internal xref">8.2.2</a>.  <a href="#name-x509-matching-one-dns-item-" class="internal xref">X.509 Matching one DNS item in issuerAltName</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.3">
                    <p id="section-toc.1-1.8.2.2.2.3.1"><a href="#section-8.2.3" class="auto internal xref">8.2.3</a>.  <a href="#name-x509-matching-one-uri-part-" class="internal xref">X.509 matching one URI part of subjectAltName</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.4">
                    <p id="section-toc.1-1.8.2.2.2.4.1"><a href="#section-8.2.4" class="auto internal xref">8.2.4</a>.  <a href="#name-x509-matching-one-uri-part-o" class="internal xref">X.509 matching one URI part of subjectAltName with a domain substring</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-old-text-on-preauth" class="internal xref">Old text on Preauth</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">More Instant Messaging Interoperability (MIMI) room policy (<span>[<a href="#I-D.ietf-mimi-room-policy" class="cite xref">I-D.ietf-mimi-room-policy</a>]</span>) defines a format that allows potential joiners that are not enumerated beforehand to be preauthorized based on properties found in their Messaging Layer Security (MLS) <span>[<a href="#RFC9420" class="cite xref">RFC9420</a>]</span> credentials.
The current version of the preauthorization format in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-mimi-room-policy-03#section-4" class="relref">Section 4</a> of [<a href="#I-D.ietf-mimi-room-policy" class="cite xref">I-D.ietf-mimi-room-policy</a>]</span> is underspecified and was designed to work with individual claims in a JSON Web Token (JWT) <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> or CBOR Web Token (CWT) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.
This document describes a syntax called claim pointers that can address claims nested inside JWT, CWT, and X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, and provides richer matching rules for parts of those claims and predicates based on them.
It could also be extended to credentials based on most general purpose structured data formats.<a href="#section-1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="structure-of-credentials">
<section id="section-3">
      <h2 id="name-structure-of-credentials">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-structure-of-credentials" class="section-name selfRef">Structure of Credentials</a>
      </h2>
<p id="section-3-1">Structured data formats use a handful of strategies for representing and organizing data.
All common structured data formats offer some type of record structure semantics. In this context this means a record contains a group of fields.
The names for record and fields differ across formats, as do their specific representations, as shown in the table below.<a href="#section-3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Format</th>
            <th class="text-left" rowspan="1" colspan="1">Representation of record</th>
            <th class="text-left" rowspan="1" colspan="1">Identifier of field</th>
            <th class="text-left" rowspan="1" colspan="1">Name of field</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">JSON</td>
            <td class="text-left" rowspan="1" colspan="1">object (preferred)</td>
            <td class="text-left" rowspan="1" colspan="1">name (quoted string)</td>
            <td class="text-left" rowspan="1" colspan="1">value</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">JSON</td>
            <td class="text-left" rowspan="1" colspan="1">array</td>
            <td class="text-left" rowspan="1" colspan="1">position</td>
            <td class="text-left" rowspan="1" colspan="1">value</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">CBOR</td>
            <td class="text-left" rowspan="1" colspan="1">map (slight preference)</td>
            <td class="text-left" rowspan="1" colspan="1">map key (often an integer)</td>
            <td class="text-left" rowspan="1" colspan="1">value</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">CBOR</td>
            <td class="text-left" rowspan="1" colspan="1">array</td>
            <td class="text-left" rowspan="1" colspan="1">position</td>
            <td class="text-left" rowspan="1" colspan="1">element</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">ASN.1</td>
            <td class="text-left" rowspan="1" colspan="1">sequence</td>
            <td class="text-left" rowspan="1" colspan="1">position or OID</td>
            <td class="text-left" rowspan="1" colspan="1">element</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TLS PL</td>
            <td class="text-left" rowspan="1" colspan="1">struct</td>
            <td class="text-left" rowspan="1" colspan="1">field name</td>
            <td class="text-left" rowspan="1" colspan="1">value</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TLS PL</td>
            <td class="text-left" rowspan="1" colspan="1">vector (not used for records)</td>
            <td class="text-left" rowspan="1" colspan="1">position</td>
            <td class="text-left" rowspan="1" colspan="1">value</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">ProtoBuf</td>
            <td class="text-left" rowspan="1" colspan="1">struct or record?</td>
            <td class="text-left" rowspan="1" colspan="1">integer field identifier</td>
            <td class="text-left" rowspan="1" colspan="1">??</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">msgpack</td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">XML</td>
            <td class="text-left" rowspan="1" colspan="1">element</td>
            <td class="text-left" rowspan="1" colspan="1">XMLPath or id attribute</td>
            <td class="text-left" rowspan="1" colspan="1">contents of element</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">XML</td>
            <td class="text-left" rowspan="1" colspan="1">attribute</td>
            <td class="text-left" rowspan="1" colspan="1">XMLPath</td>
            <td class="text-left" rowspan="1" colspan="1">value of attribute</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">CSV</td>
            <td class="text-left" rowspan="1" colspan="1">line</td>
            <td class="text-left" rowspan="1" colspan="1">position</td>
            <td class="text-left" rowspan="1" colspan="1">field</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TOML</td>
            <td class="text-left" rowspan="1" colspan="1">group</td>
            <td class="text-left" rowspan="1" colspan="1">name</td>
            <td class="text-left" rowspan="1" colspan="1">entry?</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">SQL</td>
            <td class="text-left" rowspan="1" colspan="1">row</td>
            <td class="text-left" rowspan="1" colspan="1">column name</td>
            <td class="text-left" rowspan="1" colspan="1">column/field</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">YANG</td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
          </tr>
        </tbody>
      </table>
<p id="section-3-3">In this document, we are primarily interested in structured formats commonly used in credentials, specifically JSON Web Tokens (JWT), CBOR Web Tokens (CWT), and X.509 certificates (which use ASN.1) and their derivatives.
In the context of credentials each of these specific fields is often described as a claim.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">In JSON, a record is represented as an object by convention. The individual fields in the record are identified by the object name, which is always a quoted string.
Very rarely a record is represented as an array of heterogeneous elements.
Credential claims in a JWT are present in the JWT payload object.
Lists of homogenous elements are also arrays.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">In CBOR a record is typically represented as a map (very often with assigned integer map keys).
Records could also be represented as an array of heterogeneous elements.
Lists of homogenous elements are also arrays.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">In X.509v3, a certificate contains an ASN.1 <code>SEQUENCE</code> of exactly 3 elements, the <code>tbsCertificate</code> ("to be signed certificate", which is analogous to the certificate payload), the signature algorithm, and the signature.
The certificate "payload" record is an ASN.1 <code>SEQUENCE</code> of 6 mandatory elements (certificate serial number, signature algorithm, issuer, validity, subject, and subject public key) and up to four optional elements (version, issuer unique ID, subject unique ID, and extensions).
For the purpose of matching elements in the sequence we will assign an index to each field (starting from 0) as if all 10 elements were present.
In this way, the overall structure is addressed by absolute position, while specific names, types, and extensions are identified using registered Object Identifiers (OIDs).
The extensions field contains a further syntax with a potentially large and varied basket of data structures.
Lists of items are represented as an ASN.1 <code>SEQUENCE OF</code> type, which if always of a single basic or composite type.
A composite type can contain a <code>CHOICE</code> of multiple subtypes.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">Records and lists in JSON, CBOR, and ASN.1 can be nested, sometimes deeply.
For example, the X.509 subjectAltName field can contain a list of different types of names (DNS, URI, email, etc.) that all represent the subject.
In JWT or CWT credentials, an address claim might consist of several component claims (ex: country or postal code); a language claim might consist of a list of languages; or a groups claim might contain nested claims only relevant to that specific group.<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">It is common to have a list of specific permission that have been granted in one context but not another.
For example a public relations manager might have regular access to resource A by virtue of being part of a company, access to resource B by virtue of being a full-time employee, regular access to resource C by virtue of being located in a particular country or office, moderator access to resource D by virtue of being a in public relations, and administrator access to resource E by virtue of being a manager.<a href="#section-3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="requirements-for-credential-inspection">
<section id="section-4">
      <h2 id="name-requirements-for-credential">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-requirements-for-credential" class="section-name selfRef">Requirements for Credential Inspection</a>
      </h2>
<p id="section-4-1">The following requirements were considered necessary to have a successful credential matching mechanism.<a href="#section-4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4-2">
<li id="section-4-2.1">
          <p id="section-4-2.1.1">The mechanism can represent the difference between no match, and a match with a null or undefined value.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-2.2">
          <p id="section-4-2.2.1">The mechanism can find values in JSON objects and CBOR maps by the object name or key name.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-2.3">
          <p id="section-4-2.3.1">The mechanism can find elements in ASN.1 by OID in a 2-element <code>SEQUENCE</code>.<a href="#section-4-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-2.4">
          <p id="section-4-2.4.1">The mechanism can find elements in lists or arrays by their position.<a href="#section-4-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-2.5">
          <p id="section-4-2.5.1">The mechanism can find elements in an ASN.1 <code>SEQUENCE</code> that has any combination of its optional elements.<a href="#section-4-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-2.6">
          <p id="section-4-2.6.1">The mechanism can find a single element in an list or array where one of the list/array elements contains a single "identifying" field somewhere in the array value.<a href="#section-4-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-2.7">
          <p id="section-4-2.7.1">The mechanism can find elements in array elements that require identification by multiple matching claim pointers (<strong>Maybe</strong>).<a href="#section-4-2.7.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-2.8">
          <p id="section-4-2.8.1">The mechanism can find numerical values matching simple numeric predicates, such as greater than, or less than or equal to.<a href="#section-4-2.8.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-2.9">
          <p id="section-4-2.9.1">The mechanism can find values matching well-defined parts of URIs and email addresses.<a href="#section-4-2.9.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-2.10">
          <p id="section-4-2.10.1">The mechanism can find values matching arbitrary substrings (<strong>Maybe</strong>).<a href="#section-4-2.10.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-4-3">The following requirements were considered and rejected as out of scope.<a href="#section-4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-4.1">
          <p id="section-4-4.1.1">Can the mechanism find claim values matching regular expressions? No, since regular expressions often present a security footgun; as we are defining a mechanism expressly to be used with credentials, this is an unacceptable risk.<a href="#section-4-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.2">
          <p id="section-4-4.2.1">Can the mechanism find claims using arbitrary combinations of boolean logical statements containing OR statements in a claim pointer? No, as this is likely to allow an unbounded explosion of claim combinations, and an OR mechanism can be introduced at the level of the application using the claim pointer mechanism.<a href="#section-4-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.3">
          <p id="section-4-4.3.1">Can the mechanism find claims with information from partial or incomplete nested map keys? No, since JSON only supports strings as object names, and CWT does not map keys with maps or arrays. However, this might be a straightforward extension.<a href="#section-4-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.4">
          <p id="section-4-4.4.1">Can the mechanism find multiple claims with a given query? No, this would imply a mechanism that could return a set of arbitrarily disjoint trees, instead of returning a single result (or no match).<a href="#section-4-4.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="matching-claims">
<section id="section-5">
      <h2 id="name-matching-claims">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-matching-claims" class="section-name selfRef">Matching claims</a>
      </h2>
<p id="section-5-1">In this section we introduce a method of matching claims in credentials that we describe here as Claim Pointers.
A claim pointer follows the hierarchy of a credential from its root to a specific claim, through a sequence of specifiers per level. Each level is described using a <code>ClaimPointerUnit</code> object.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">For the purposes of this section, a level of hierarchy in JSON is the value of any object, or an element of an array. In CBOR a level of hierarchy is the value of any map key, an element of an array, or the contents of a tag. In ASN.1 a level of hierarchy is an element of either a <code>SEQUENCE</code> or <code>SEQUENCE OF</code>.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">For explanatory purposes, we will provide an example JWT payload here to demonstrate some of the claim matching options. Additional examples will be introduced as needed.<a href="#section-5-3" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-5-4">
<pre>
{                                   # contents are at level 1
  "iss": "https://issuer.example",
  ...
  "known_entity": true,
  "orig_timestamp": 1549560720,
  "nodes": [                        # contents are at level 2
    {                               # contents are at level 3
      ...
      "processor": "DCBA-101777",
      "origin": {                   # contents are at level 4
        "country": "us",
        ...
      },
      "domain": "smart.example"
      "eur_per_hour": 273.15
    },
    ...
  ],
  "service_flags": [false, false, true, false]
}
</pre><a href="#section-5-4" class="pilcrow">¶</a>
</div>
<div id="matching-map-keys-object-names-and">
<section id="section-5.1">
        <h3 id="name-matching-map-keys-object-na">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-matching-map-keys-object-na" class="section-name selfRef">Matching Map Keys, Object Names, and</a>
        </h3>
<p id="section-5.1-1">The value of an object in JSON or the value of a map in CBOR is accessed by its JSON name or CBOR map key, using the <code>map_key</code> pointer unit type.
For JSON the <code>opaque_key</code> to be compared with the key is a double-quoted JSON string that matches the object name.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">For CBOR the <code>opaque_key</code> is the ordinary encoding <span>[<a href="#I-D.ietf-cbor-serialization" class="cite xref">I-D.ietf-cbor-serialization</a>]</span> that matches the map key.
For example the CBOR map keys of 1 (unsigned integer), -1 (negative integer), '1' (byte string), "1" (text string), 1(0) (a timestamp at the start of the UNIX epoch), and 1.0 (float) match the <code>opaque_key</code>s of 0x01, 0x20, 0x41 0x31, 0x61 0x31, 0xC1 0x00, and 0xF9 0x3C 0x00 respectively.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">In X.509, a common pattern is to have a <code>SEQUENCE</code> of 2 elements consisting of an OID and data element (its "value").
The data element of such a 2 element <code>SEQUENCE</code> matches when its <code>opaque_key</code> is equal to the DER representation of its OID (excluding the OID type and length).<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">This pointer unit points to ("returns") the value corresponding to the object name, map key, or element in the <code>SEQUENCE</code>.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">When evaluating the JWT payload above, the following claim pointer points at the value <code>true</code>, since that is the value of the <code>known_entity</code> claim.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-6">
<pre>
claim_pointer = [
  [
    token_type = map_key,
    opaque_key = "known_entity"
  ]
]
claim_pointer[0].unit_type = map_key; /* 0 */
claim_pointer[0].opaque_key = "known_entity";


/* This feels like nicer names to me */
pointer_unit[0].unit_type = via_key;
pointer_unit[0].key.type = string;
pointer_unit[0].key.value = "known_entity";
</pre><a href="#section-5.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="matching-lists-and-sequences-by-absolute-position">
<section id="section-5.2">
        <h3 id="name-matching-lists-and-sequence">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-matching-lists-and-sequence" class="section-name selfRef">Matching Lists and Sequences by Absolute Position</a>
        </h3>
<p id="section-5.2-1">The value of an element in an absolute position in a list is accessed using the <code>array_position</code> pointer unit type.
The <code>index</code> value corresponds to the position counting from 0.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">The claim pointer below using the example JSON document above would point at the value <code>true</code> as well, the 3rd element of the <code>service_flags</code> array.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-3">
<pre>
claim_pointer = [
  [
    token_type = map_key,
    opaque_key = "service_flags"
  ],  /* points to entire array */
  [
    token_type = array_position,
    index = 2
  ]
]

/* claim_pointer[0] points to entire array */
claim_pointer[0].unit_type = map_key; /* 0 */
claim_pointer[0].opaque_key = "service_flags";

/* claim_pointer[1] points to 3rd element (true) */
claim_pointer[1].unit_type = array_position; /* 1 */
claim_pointer[1].index = 2;
</pre><a href="#section-5.2-3" class="pilcrow">¶</a>
</div>
<p id="section-5.2-4">If there is no array, or the array does not have an element at the requested position, the claim pointer does not point at anything.
If the <code>index</code> above was instead 7, or the value of <code>service_flags</code> was not an array, the claim pointer would not point at any value.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">As previously mentioned, the elements of an X.509 <code>SEQUENCE</code> with optional elements (such as <code>tbsCertificate</code>) are given a logical position from zero as if all possible optional elements are present.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="matching-an-element-in-a-list-by-an-identifier-in-the-list">
<section id="section-5.3">
        <h3 id="name-matching-an-element-in-a-li">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-matching-an-element-in-a-li" class="section-name selfRef">Matching an Element in a List by an Identifier in the List</a>
        </h3>
<p id="section-5.3-1">The <code>array_search</code> claim pointer unit type, can search an array of an ASN.1  <code>SEQUNCE OF</code> for the first entry which matched the nested claim pointer in <code>nested_claim_pointer</code>.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">The claim pointer below begins by pointing at the value of the entire <code>nodes</code> array.
Then, starting from the <code>nodes</code> array, its nested claim pointer points at the value of the <code>processor</code> object and compares it to the string value "DCBA-10177".
Finding a match, the top-level claim_pointer now points at the first element in the <code>nodes</code> array.
Finally, the next claim pointer unit looks for a <code>domain</code> object in the first element of the <code>nodes</code> array.
The claim pointer now points at the value "smart.example".<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-3">
<pre>
claim_pointer = [
  [
    token_type = map_key,
    opaque_key = "nodes"
  ], /* points to entire array of nodes elements */
  [
    token_type = array_search,
    nested_claim_pointer = [{
      claim_pointer = [
        [
          token_type = map_key,
          opaque_key = "processor"
        ]    /* find an element with a `processor` object */
      ],
      value_semantics = string,  /* of type string         */
      match_on = utf8_ci,        /* UTF-8 case insensitive */
      test_value = "DCBA-10177"  /* matching this value    */
    }]
  ], /* pointer is at first element of the nodes array */
  [
    token_type = map_key,
    opaque_key = "domain"
  ]
]
</pre><a href="#section-5.3-3" class="pilcrow">¶</a>
</div>
<p id="section-5.3-4">Instead imagine searching for the value of <code>processor</code> in the first element that matches the <code>domain</code> "smart.example".
We would use the following claim_pointer instead, which would point to the value "DCBA-10177" in the first element's <code>processor</code> object.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-5">
<pre>
claim_pointer = [
  [
    token_type = map_key,
    opaque_key = "nodes"
  ], /* points to entire array of nodes elements */
  [
    token_type = array_search,
    nested_claim_pointers = [{
      claim_pointer = [
        [
          token_type = map_key,
          opaque_key = "domain"
        ]    /* find an element with a `domain` object */
      ],
      value_semantics = domain,    /* of type domain         */
      match_on = domain_name,      /* match a valid domain   */
      test_value = "smart.example" /* with this value        */
    }]
  ], /* pointer is at first element of the nodes array */
  [
    token_type = map_key,
    opaque_key = "processor"
  ]
]
</pre><a href="#section-5.3-5" class="pilcrow">¶</a>
</div>
<p id="section-5.3-6">Finally, imagine that the value of the <code>domain</code> field was instead "xn--ingnieux-d1a.example", the <code>match_on</code> type was "punycode" and the <code>test_value</code> was "ingénieux.example".
This would also point to the same value ("DCBA-10177") since the punycode representation of the Internationalized Domain Name (IDN) or "punycode" representation of "ingénieux.example" is "xn--ingnieux-d1a.example".<a href="#section-5.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="matching-multiple-claim-pointers">
<section id="section-5.4">
        <h3 id="name-matching-multiple-claim-poi">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-matching-multiple-claim-poi" class="section-name selfRef">Matching multiple claim pointers</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-5.4-1">
<pre>
claim_pointer = [
  [
    token_type = map_key,
    opaque_key = "nodes"
  ], /* points to entire array of nodes elements */
  [
    token_type = array_search,
    nested_claim_pointers = [
      {
        claim_pointer = [
          [
            token_type = map_key,
            opaque_key = "domain"
          ]    /* find an element with a `domain` object */
        ],
        value_semantics = domain,    /* of type domain         */
        match_on = domain_name,      /* match a valid domain   */
        test_value = "smart.example" /* with this value        */
      },
      {
        claim_pointer = [
          [
            token_type = map_key,
            opaque_key = "origin"
          ],
          [
            token_type = map_key,
            opaque_key = "country"
          ]
        ],
        value_semantics = string,
        match_on = utf8ci,
        test_value = "us"
      }
    ] /* first element with both country = us           */
      /*                     AND domain = smart.example */
  ], /* pointer is at first element of the nodes array */
  [
    token_type = map_key,
    opaque_key = "processor"
  ]
]
</pre><a href="#section-5.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="matching-with-numerical-predicates">
<section id="section-5.5">
        <h3 id="name-matching-with-numerical-pre">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-matching-with-numerical-pre" class="section-name selfRef">Matching with Numerical Predicates</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-5.5-1">
<pre>
  test_value = "eur_per_hour"

value_semantics = number,
match_on = number,
operation = greater_or_equal,
test_value = 200.0
</pre><a href="#section-5.5-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="matching-parts-of-uris-and-email-addresses">
<section id="section-5.6">
        <h3 id="name-matching-parts-of-uris-and-">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-matching-parts-of-uris-and-" class="section-name selfRef">Matching Parts of URIs and email addresses</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-5.6-1">
<pre>
value_semantics = uri,
match_on = hostpart,
test_value = "example.com"
</pre><a href="#section-5.6-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="matching-arbitrary-substrings">
<section id="section-5.7">
        <h3 id="name-matching-arbitrary-substrin">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-matching-arbitrary-substrin" class="section-name selfRef">Matching Arbitrary Substrings</a>
        </h3>
<p id="section-5.7-1">mimi://example.com/u/46133c9e-df4c-4c88-91d2-00a527bdd0f7<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.7-2">
<pre>
value_semantics = uri,
match_on = uripath,
operation = substring,
  start = 3,
  length = 36
test_value = "46133c9e-df4c-4c88-91d2-00a527bdd0f7"
</pre><a href="#section-5.7-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="some-scraps-here">
<section id="section-6">
      <h2 id="name-some-scraps-here">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-some-scraps-here" class="section-name selfRef">some scraps here</a>
      </h2>
<p id="section-6-1">A ClaimPointerUnit can consist of a handful of types<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2"><code>map_key</code><a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3"><code>array_index</code><a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4"><code>index</code> matches the 0-indexed element of the array<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5"><code>array_search</code><a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">matches the first element in the searched array which matches all of the <code>nested_claim_pointers</code><a href="#section-6-6" class="pilcrow">¶</a></p>
<p id="section-6-7">it returns the value of the found array element<a href="#section-6-7" class="pilcrow">¶</a></p>
<p id="section-6-8">for example<a href="#section-6-8" class="pilcrow">¶</a></p>
<p id="section-6-9"><code>map_search</code><a href="#section-6-9" class="pilcrow">¶</a></p>
<p id="section-6-10">is less commonly used, but needed when accessing a map key that itself has a nested structure<a href="#section-6-10" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-6-11">
<pre>
{
  "abc": "foo"
  "def": [
     "carrot",
     "tomato",
     2.5,
     true
  ],
  "ghi": [
    [
    ],
    [
    ],
    {
      "roles": ["Employees", "Boston", "PR", "Manager"],
      "start_date": "01-Apr-2021"
    }
  ],
  "jkl": {
     "AAA": "all \"a\"'s",
     "BBB": "all b's"
  },
  "xyz": 1.0
}
</pre><a href="#section-6-11" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-6-12">
<pre>
claim_pointer = [
  [
    token_type = map_key,
    opaque_key = "known_entity"
  ]
]
match_on = bool,
opaque_value = true
MATCH

claim_pointer = [
  [
    token_type = map_key,
    opaque_key = "some_nonexistent_key"
  ]
]
/* value is null */
match_on = bool,
opaque_value = true
NO MATCH

claim_pointer = [
  [
    token_type = array_position,
    index = 3
  ]
]
/* value is null (there is no array or has fewer elements) */
match_on = utf8_ci,
opaque_value = "us"
NO MATCH


claim_pointer = [
  [
    token_type = map_key,
    opaque_key = "service_flags"
  ],  /* points to entire array */
  [
    token_type = array_position,
    index = 2
  ]
]
/* value is [ true ] (value of 3rd element in array) */
match_on = bool,
opaque_value = true
MATCH

claim_pointer = [
  [
    token_type = map_key,
    opaque_key = "nodes"
  ], /* points to entire array of nodes elements */
  [
    token_type = array_search,
    nested_claim_pointer = [
      [
        token_type = map_key,
        opaque_value = "processor"
      ]
    ],
    match_on = string,
    test_value = "DCBA-10177"
    MATCH
  ], /* pointer is at first element of the nodes array */
  [
    token_type = map_key,
    opaque_key = "domain"
  ]
]
/* value is [ "smart.example" ] */
match_on = domain
opaque_value = "smart.example"
MATCH
</pre><a href="#section-6-12" class="pilcrow">¶</a>
</div>
<p id="section-6-13">Imagine the match is on an IDN domain and the value of the <code>domain</code> object was "xn--ingnieux-d1a.example".<a href="#section-6-13" class="pilcrow">¶</a></p>
<p id="section-6-14">match_on = punycode
test_value = "ingénieux.example"<a href="#section-6-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-15">
<pre>
claim_pointer = [
  [
    token_type = map_key,
    opaque_key = "nodes"
  ], /* points to entire array of nodes elements */
  [
    token_type = array_search,
    nested_claim_pointer = [
      [
        token_type = map_key,
        opaque_value = "origin"
      ], /* value of first element is origin map */
      [
        token_type = map_key,
        test_value = "country"
      ] /* value of first element is "us" */
    ],
    match_on = string,
    test_value = "us"
    MATCH
  ], /* pointer is at first element of the nodes array */
  [
    token_type = map_key,
    opaque_key = "domain"
  ]
]
/* value is [ "smart.example" ] */
match_on = domain
opaque_value = "smart.example"
MATCH


</pre><a href="#section-6-15" class="pilcrow">¶</a>
</div>
<p id="section-6-16">NEXT example match both processor and domain in array_search
claim_pointer =<a href="#section-6-16" class="pilcrow">¶</a></p>
<p id="section-6-17">NEXT example match predicate ≥ 200.00 eur per hour
does this require ANDs to get ranges?<a href="#section-6-17" class="pilcrow">¶</a></p>
<p id="section-6-18">NEXT example well-defined parts of URIs and email<a href="#section-6-18" class="pilcrow">¶</a></p>
<p id="section-6-19">NEXT example substrings<a href="#section-6-19" class="pilcrow">¶</a></p>
</section>
</div>
<div id="match-syntax-definition">
<section id="section-7">
      <h2 id="name-match-syntax-definition">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-match-syntax-definition" class="section-name selfRef">Match Syntax Definition</a>
      </h2>
<div class="breakable lang-tls sourcecode" id="section-7-1">
<pre>
enum {
    reserved (0),
    x509 (1),
    jwt (2),
    cwt(3),
    (255)
} ClaimFamily;

enum {
    number,
    int,
    float,
    bool,
    date,
    bytes (0),
    string (1),
    domain (2),
    uri (3),
    https_uri,
    mimi_uri,
    email (4),
    (255)
} ClaimSemantics;

enum {
    exists,
    number,
    int,
    uint,
    float,
    finite_float,
    bool,
    secs_since_epoch,
    iso8601,
    bytes (0),
    hex,
    base64,
    base64url,
    der,
    pem,
    ipv4,
    ipv6,
    deterministic_cbor,
    utf8 (1),
    utf8_ci ,
    nfc,
    nfd,
    canonical_json,
    domain (2),
    punycode,
    email_address,
    generic_uri,
    https_uri,
    userpart (6),
    hostpart (7),
    uri_path (8),
    mimi_uri,
    user_id (3),
    device_id (4),
    room_id (5),
    (255)
} MatchOn;

enum {
    member_name (0),
    array_position (1),
    array_search (2),
    tagged_value (3), /* CBOR only */
    bstr_encoded (4), /* CBOR only */
    (255)
} ClaimUnitType;




struct {
    JwtTokenType token_type;
    select (token_type) {
        case member_name:
            opaque name&lt;V&gt;;
        case array_index:
            uint index;
    }
} JwtToken;

struct {
    JwtToken claim_pointer&lt;V&gt;;
} JwtClaimRoot;

enum {
    map_key (0),
    array_index (1),
    tagged_value (2),
    bstr_encoded (3),
    (255)
} TokenType;

struct {
    TokenType token_type;
    select (token_type) {
        case map_key:
            opaque opaque_key&lt;V&gt;;
        case array_index:
            uint index;
        case array_search:
            ClaimMatch nested_matches&lt;V&gt;;
        case tagged_value:
            uint tag;
        case bstr_encoded:
            struct {};
    }
} ClaimPointerUnit;

enum {
    equal (0),
    less_than (1),
    less_than_or_equal (2),
    greater_than (3),
    greater_than_or_equal (4),
    len_bytes,
    len_chars,
    contains,
    starts_with,
    ends_with,
    substring,
    path_slice,
} OperationType;

struct {
  OperationType operation_type;
  select (operation_type) {
    case starts_with:
        optional&lt;uint&gt; length;
    case ends_width:
        optional&lt;uint&gt; length;
    case substring:
        uint start_position;
        uint length;
    case path_slice:
        uint path_index;
  };
} Operation;

struct {
    ClaimPointerUnit claim_pointer&lt;V&gt;;
    ClaimSemantics claim_semantics;
    MatchOn match_on;
    optional&lt;Operation&gt; operation;
    opaque matching_value&lt;V&gt;;
} ClaimMatch

struct {
    ClaimFamily claim_family;
    select (claim_family) {
        case json:
            JsonType json_type;
            select (json_type) {
                case number:
                    Double value;
                case string:
                case object:
                case array:
                    Bytes value;
                case no_match:
                case true:
                case false:
                case null:
                    struct {};
            }
        case cbor:
            Bytes cbor_encoding;
        case asn1:
    };
} MapKey

case no_match:
    struct {};
case uint:
case nint:
    uint64 value;
case float
    Double value;
case array:
case map:
case text_string:
case byte_string:
    Bytes value;
case tag:
    uint64 tag;
    Bytes value;
case undefined:
    select {};
case simple:
    uint8 value;


enum JsonType {
    no_match (0),
    number (1),
    string (2),
    object (3),
    array (4),
    true (5),
    false (6),
    null (7)
    (255)
}



struct {
    CwtToken claim_pointer&lt;V&gt;;
} CwtClaimRoot;

struct {
    ClaimFamily claim_family;
    select (claim_family) {
        case x509:
            opaque oid&lt;V&gt;;
        case jwt:
            JwtClaimRoot claim_root;
        case cwt:
            CwtClaimRoot claim_root;
    }
    ClaimSemantics claim_semantics;
    MatchOn match_on;
    bool match_any_in_list;
    opaque target_value&lt;V&gt;;
} Claim;
</pre><a href="#section-7-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="more-examples">
<section id="section-8">
      <h2 id="name-more-examples">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-more-examples" class="section-name selfRef">More examples</a>
      </h2>
<div id="cbor-examples">
<section id="section-8.1">
        <h3 id="name-cbor-examples">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-cbor-examples" class="section-name selfRef">CBOR Examples</a>
        </h3>
<div class="lang-cbor-diag sourcecode" id="section-8.1-1">
<pre>
{                                   # contents are level 1
  1: "https://issuer.example",
  ...
  502: 1(1549560720),               # tagged value is level 2
  504: [                            # contents are level 2
    {                               # contents are level 3
      ...
      501: "DCBA-101777",
      503: {                        # contents are level 4
        1: "us",
        ...
      },
      505: 4(                       # decimal fraction tag
        [                           #   273.15
          -2,
          27315                     # level 5
        ]
      )
    },
    ...
  ],
  509: [false, false, true, false]
}
</pre><a href="#section-8.1-1" class="pilcrow">¶</a>
</div>
<div id="cbor-example-with-tagged-value-access-directly-as-opaquevalue">
<section id="section-8.1.1">
          <h4 id="name-cbor-example-with-tagged-va">
<a href="#section-8.1.1" class="section-number selfRef">8.1.1. </a><a href="#name-cbor-example-with-tagged-va" class="section-name selfRef">CBOR example with tagged value access directly as opaque_value</a>
        </h4>
</section>
</div>
<div id="cbor-example-parsing-into-tagged-value">
<section id="section-8.1.2">
          <h4 id="name-cbor-example-parsing-into-t">
<a href="#section-8.1.2" class="section-number selfRef">8.1.2. </a><a href="#name-cbor-example-parsing-into-t" class="section-name selfRef">CBOR example parsing into tagged value</a>
        </h4>
</section>
</div>
<div id="cbor-example-with-custom-simple-values-maybe-not-needed">
<section id="section-8.1.3">
          <h4 id="name-cbor-example-with-custom-si">
<a href="#section-8.1.3" class="section-number selfRef">8.1.3. </a><a href="#name-cbor-example-with-custom-si" class="section-name selfRef">CBOR example with custom simple values ?? - maybe not needed</a>
        </h4>
</section>
</div>
</section>
</div>
<div id="x509-examples">
<section id="section-8.2">
        <h3 id="name-x509-examples">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-x509-examples" class="section-name selfRef">X.509 Examples</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-8.2-1">
<pre>
SEQUENCE (1 elem)
  SET (1 elem)
    SEQUENCE (2 elem)
      OBJECT IDENTIFIER 2.5.4.3 commonName (X.520 DN component)
      PrintableString github.com
...
    SEQUENCE (3 elem)
      OBJECT IDENTIFIER 2.5.29.15 keyUsage (X.509 extension)
      BOOLEAN true
      OCTET STRING (4 byte) 03020780
        BIT STRING (1 bit) 1
    SEQUENCE (3 elem)
      OBJECT IDENTIFIER 2.5.29.19 basicConstraints (X.509 extension)
      BOOLEAN true
      OCTET STRING (2 byte) 3000
        SEQUENCE (0 elem)
    SEQUENCE (2 elem)
      OBJECT IDENTIFIER 2.5.29.37 extKeyUsage (X.509 extension)
      OCTET STRING (22 byte) 301406082B0601050507030106082B06010505070302
        SEQUENCE (2 elem)
          OBJECT IDENTIFIER 1.3.6.1.5.5.7.3.1 serverAuth (PKIX key purpose)
          OBJECT IDENTIFIER 1.3.6.1.5.5.7.3.2 clientAuth (PKIX key purpose)
...
    SEQUENCE (2 elem)
      OBJECT IDENTIFIER 2.5.29.17 subjectAltName (X.509 extension)
      OCTET STRING (30 byte) 301C820A6769746875622E636F6D820E7777772E6769746875622E636F6D
        SEQUENCE (2 elem)
          [2] (10 byte) github.com
          [2] (14 byte) www.github.com
</pre><a href="#section-8.2-1" class="pilcrow">¶</a>
</div>
<div id="simple-x509-example-cn">
<section id="section-8.2.1">
          <h4 id="name-simple-x509-example-cn">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-simple-x509-example-cn" class="section-name selfRef">Simple X.509 example (CN)</a>
        </h4>
</section>
</div>
<div id="x509-matching-one-dns-item-in-issueraltname">
<section id="section-8.2.2">
          <h4 id="name-x509-matching-one-dns-item-">
<a href="#section-8.2.2" class="section-number selfRef">8.2.2. </a><a href="#name-x509-matching-one-dns-item-" class="section-name selfRef">X.509 Matching one DNS item in issuerAltName</a>
        </h4>
</section>
</div>
<div id="x509-matching-one-uri-part-of-subjectaltname">
<section id="section-8.2.3">
          <h4 id="name-x509-matching-one-uri-part-">
<a href="#section-8.2.3" class="section-number selfRef">8.2.3. </a><a href="#name-x509-matching-one-uri-part-" class="section-name selfRef">X.509 matching one URI part of subjectAltName</a>
        </h4>
</section>
</div>
<div id="x509-matching-one-uri-part-of-subjectaltname-with-a-domain-substring">
<section id="section-8.2.4">
          <h4 id="name-x509-matching-one-uri-part-o">
<a href="#section-8.2.4" class="section-number selfRef">8.2.4. </a><a href="#name-x509-matching-one-uri-part-o" class="section-name selfRef">X.509 matching one URI part of subjectAltName with a domain substring</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-8.2.4-1">
<pre>
claim_pointer = [
  [
    type = oid,
    value = 2.5.29.17 = 0x55 1d 11   # subjectAltName
  ],
  [
    type = array_serach,
    nested_claim_pointer = [
      [
      ]
    ],
    semantics = uri,
    match_on = domain / userpart / user_id
    test_value = "provider.example"
    MATCH
  ] /* value is [ ["URI", "https://provider.example/path"] ] */
],
semantics = uri,
match_on = exists,
test_value = true
MATCH

try email?  match domain in nester pointer, match on user in main match??
</pre><a href="#section-8.2.4-1" class="pilcrow">¶</a>
</div>
<p id="section-8.2.4-2">RFC5820 matches only host part of URIs??<a href="#section-8.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="old-text-on-preauth">
<section id="section-9">
      <h2 id="name-old-text-on-preauth">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-old-text-on-preauth" class="section-name selfRef">Old text on Preauth</a>
      </h2>
<p id="section-9-1">Preauthorized users are MIMI users and external senders that have authorization to adopt a role in a room by virtue of certain credential claims or properties, as opposed to being individually enumerated in the participant list.
For example, a room for employee benefits might be available to join with the regular participant role to all full-time employees with a residence in a specific country; while anyone working in the human resources department might be able to join the same room as a moderator.
This data structure is consulted in two situations: for external joins (external commits) and external proposals when the requester does not already appear in the participant list; and separately when an existing participant explicitly tries to change its <em>own</em> role.<a href="#section-9-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9-2.1">
          <p id="section-9-2.1.1">Only consulting Preauthorized users in these cases prevents several attacks. For example, it prevents an explicitly banned user from rejoining a group based on a preauthorization.<a href="#section-9-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-9-3">PreAuthData is the format of the <code>data</code> field inside the ComponentData struct for the Preauthorized Participants component in the <code>application_data</code> GroupContext extension.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">The individual <code>PreAuthRoleEntry</code> rules in <code>PreAuthData</code> are consulted one at a time.
A <code>PreAuthRoleEntry</code> matches for a requester when every <code>Claim.claim_id</code> has a corresponding claim in the requester's MLS Credential which exactly matches the corresponding <code>claim_value</code>.
When the rules in a Preauthorized users struct match multiple roles, the requesting client receives the first role which matches its claims.<a href="#section-9-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9-5.1">
          <p id="section-9-5.1.1"><strong>TODO</strong>: refactor Claims<a href="#section-9-5.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div class="lang-tls-presentation sourcecode" id="section-9-6">
<pre>
struct {
  /* MLS Credential Type of the "claim"  */
  CredentialType credential_type;
  /* the binary representation of an X.509 OID, a JWT claim name  */
  /* string, or the CBOR map claim key in a CWT (an int or tstr)  */
  opaque id&lt;V&gt;;
} ClaimId;

struct {
  ClaimId claim_id;
  opaque claim_value&lt;V&gt;;
} Claim;

struct {
  /* when all claims in the claimset are satisfied, the claimset */
  */ is satisfied */
  Claim claimset&lt;V&gt;;
  Role target_role;
} PreAuthRoleEntry;

struct {
  PreAuthRoleEntry preauthorized_entries&lt;V&gt;;
} PreAuthData;

PreAuthData preauth_list;
PreAuthData PreAuthUpdate;
</pre><a href="#section-9-6" class="pilcrow">¶</a>
</div>
<p id="section-9-7">PreAuthUpdate (which has the same format as PreAuthData) is the format of the <code>update</code> field inside the AppDataUpdate struct in an AppDataUpdate Proposal for the Preauthorized Participants component.
If the contents of the <code>update</code> field are valid and if the proposer is authorized to generate such an update, the value of the <code>update</code> field completely replaces the value of the <code>data</code> field.<a href="#section-9-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9-8.1">
          <p id="section-9-8.1.1">As with the definition of roles, in MIMI it is not expected that the definition of Preauthorized users would change frequently. Instead the claims in the underlying credentials would be modified without modifying the preauthorization policy.<a href="#section-9-8.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-9-9">Changing Preauthorized user definitions is sufficiently disruptive, that an update to this component is not valid if it appears in the same commit as any Participant List change, except for user removals.<a href="#section-9-9" class="pilcrow">¶</a></p>
<p id="section-9-10">Because the Preauthorized users component usually authorizes non-members, it is also a natural choice for providing concrete authorization for policy enforcing systems incorporated into or which run in coordination with the MIMI Hub provider or specific MLS Distribution Services. For example, a preauthorized role could allow the Hub to remove participants and to ban them, but not to add any users or devices. This unifies the authorization model for members and non-members.<a href="#section-9-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">TODO Security<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-11-1">This document has no IANA actions.<a href="#section-11-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-normative-references">
<section id="section-12">
      <h2 id="name-normative-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="I-D.ietf-cbor-serialization">[I-D.ietf-cbor-serialization]</dt>
      <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refTitle">"CBOR Serialization and Determinism"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cbor-serialization-01</span>, <time datetime="2025-12-05" class="refDate">5 December 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-serialization-01">https://datatracker.ietf.org/doc/html/draft-ietf-cbor-serialization-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-mimi-room-policy">[I-D.ietf-mimi-room-policy]</dt>
      <dd>
<span class="refAuthor">Mahy, R.</span>, <span class="refTitle">"Room Policy for the More Instant Messaging Interoperability (MIMI) Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-mimi-room-policy-03</span>, <time datetime="2025-12-18" class="refDate">18 December 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-mimi-room-policy-03">https://datatracker.ietf.org/doc/html/draft-ietf-mimi-room-policy-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
      <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9420">[RFC9420]</dt>
    <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Beurdouche, B.</span>, <span class="refAuthor">Robert, R.</span>, <span class="refAuthor">Millican, J.</span>, <span class="refAuthor">Omara, E.</span>, and <span class="refAuthor">K. Cohn-Gordon</span>, <span class="refTitle">"The Messaging Layer Security (MLS) Protocol"</span>, <span class="seriesInfo">RFC 9420</span>, <span class="seriesInfo">DOI 10.17487/RFC9420</span>, <time datetime="2023-07" class="refDate">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9420">https://www.rfc-editor.org/rfc/rfc9420</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rohan Mahy</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rohan.ietf@gmail.com" class="email">rohan.ietf@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
